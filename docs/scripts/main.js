"use strict";var APP={cache:{},initBefore:function(){APP.polyfills(),APP.svgIcons(),document.documentElement.className=document.documentElement.className.replace("no-js","js")},init:function(){APP.detectIE(),APP.lazyload(),APP.buttons(),APP.modalCloseBtn(),APP.closeOnFocusLost(),APP.setCurrentPosition(),APP.mapOptions(),APP.setFixedCoordsForm(),APP.tooltipsInit(),APP.mouseOverMap(),APP.ctrlVInit(),APP.rssParser(),APP.modalGallery()},getClipboardText:function(e){navigator.clipboard.readText().then(function(t){e(t)}).catch(function(t){console.warn("Failed to read clipboard contents: ",t)})},parseGameCoords:function(t){return t.replace(/(?:\r\n|\r|\n)/g," ").match(/Lat\: (-?\d+).+Long\: (-?\d+)/i)},buttons:function(){Array.prototype.forEach.call(document.querySelectorAll(".menu-trigger"),function(t){t.addEventListener("click",function(){document.body.classList.toggle("nav-showed")})})},rssParser:function(){var t=function(){(new RSSParser).parseURL("https://cors-anywhere.herokuapp.com/https://steamcommunity.com/games/TheIsle/rss/",function(t,e){t?document.querySelector(".news-feed__loader").innerHTML=t:(APP.cache.feedItems=e.items,e.items.forEach(function(t,e){e<3&&(console.log(t),a(t))}),i())})},a=function(t){var e=l(t.isoDate),n=document.getElementById("feed-item").innerHTML,o=_.template(n)(t),r=document.getElementById("feed-list"),a=APP.createElementFromHTML(o);a.querySelector("[data-content]").innerHTML=t.content,a.querySelector("[data-date]").innerHTML=e,r.appendChild(a),c(a),setTimeout(function(){a.classList.add("animated")},10)},l=function(t){var e=new Date(t),n=e.getDate(),o=e.getMonth()+1;return(n<10?"0"+n:n)+"."+(o<10?"0"+o:o)+"."+e.getFullYear()},i=function(){APP.tooltipsInit(),e()},e=function(){document.querySelector(".news-feed").classList.add("news-feed--loaded")},c=function(t){t.querySelector(".item-feed__btn-more").addEventListener("click",function(t){var e=this.closest(".item-feed"),n="item-feed--full-view";e.hasClass(n)?(e.classList.remove(n),(new SmoothScroll).animateScroll(e,0,{speed:300})):e.classList.add(n)})},n=function(){var r=document.querySelector(".news-feed__btn-more");r.addEventListener("click",function(t){var e=document.querySelectorAll(".news-feed__item").length,n=APP.cache.feedItems,o=_.drop(n,e);o.length&&(o.forEach(function(t,e){e<3&&a(t)}),i()),o.length<3&&(r.style.display="none")})};document.getElementById("feed-list")&&(t(),n())},createElementFromHTML:function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild},ctrlVInit:function(){var t=document.querySelector(".js-ctrl-v");if(t){var n=document.getElementById("lat"),o=document.getElementById("lng"),r=function(t){var e=APP.parseGameCoords(t);e?(APP.cache.tingleModal&&APP.cache.tingleModal.close(),n.value=e[1],o.value=e[2],o.closest("form").querySelector("button[type=submit]").click()):APP.customAlert('\n\t\t\t\t\t<div class="content-style text-center">\n\t\t\t\t\t\t<div class="h1 mb-4">Invalid clypboard text</div>\n\t\t\t\t\t\t<p>Youre text is: <b>"'+t+'"</b></p>\n\t\t\t\t\t\t<p>Please copy in-game coordinates or use the form</p>\n\t\t\t\t\t</div>\n\t\t\t\t')},e=function(e){navigator.permissions.query({name:"clipboard-read"}).then(function(t){"granted"==t.state||"prompt"==t.state?e():APP.customAlert('\n\t\t\t\t<form id="pasted-coords">\n\t\t\t\t\t<div class="row">\n\t\t\t\t\t\t<div class="col form-group">\n\t\t\t\t\t\t\t<input type="text" class="form-control form-control--light-bg" name="in-game-coords" placeholder="Paste in-game coords" required="">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="col-auto form-group">\n\t\t\t\t\t\t\t<button class="btn btn--narrow btn--blue" type="submit">Set</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t\t<div class="content-style text-center">\n\t\t\t\t\t<p>Please grant access clipboard read permissions for faster setting points or just use the form.</p>\n\t\t\t\t</div>\n\t\t\t',function(t){var n=t.modal.querySelector("input[name=in-game-coords]");n.focus(),document.getElementById("pasted-coords").addEventListener("submit",function(t){t.preventDefault();var e=n.value;r(e)})})})};t.addEventListener("click",function(t){t.preventDefault(),e(function(){APP.getClipboardText(r)})})}},customAlert:function(t,e,n){function o(t,e){t.setContent('<div class ="modal modal--alert">\n\t\t\t\t<span class="js-modal-close modal__close">×</span>\n\t\t\t\t'+e+"\n\t\t\t</div>")}var r;APP.cache.tingleModal?o(APP.cache.tingleModal,t):(APP.cache.tingleModal=r=new tingle.modal({closeMethods:["overlay","button","escape"],closeLabel:"Close",cssClass:["tingle-modal--alert"],beforeOpen:function(){document.body.style.marginRight=APP.getScrollbarSize()+"px"},onOpen:function(){document.activeElement.blur(),APP.modalCloseListener(this),e&&e(this)},beforeClose:function(){return document.body.removeAttribute("style"),!0},onClose:function(){r.destroy(),delete APP.cache.tingleModal,n&&n(this)}}),o(APP.cache.tingleModal,t),APP.cache.tingleModal.open())},closeOnFocusLost:function(){document.addEventListener("click",function(t){t.target.closest(".header")||document.body.classList.remove("nav-showed")})},tooltipsInit:function(){tippy("[data-tippy-content]",{animation:"fade",arrow:!0,arrowType:"round"});Array.prototype.forEach.call(document.querySelectorAll(".js-tooltip"),function(t){var e=t.querySelector(".js-tooltip-content");tippy(t,{content:e,theme:"light-border",interactive:!0,arrow:!0,trigger:"click",arrowType:"round"}),e.classList.remove("d-none")})},mapOptions:function(){var t=document.querySelector(".map-settings form"),n=document.querySelector(".map"),o="map--hide-markers",r="map--invisible-markers";t&&Array.prototype.forEach.call(t.querySelectorAll("input"),function(e){e.addEventListener("change",function(t){switch(e.getAttribute("name")){case"hidden-markers":!function(t){t.checked?n.classList.add(o):n.classList.remove(o)}(e);break;case"invisible-markers":!function(t){t.checked?n.classList.add(r):n.classList.remove(r)}(e);break;default:console.log("options switched")}})})},getMapSize:function(t){switch(0<arguments.length&&void 0!==t?t:"thenyaw"){case"thenyaw":return{x:745,y:675};case"v3":return{x:1600,y:1600};default:return{x:1e3,y:1e3}}},getMapCenter:function(t){switch(0<arguments.length&&void 0!==t?t:"thenyaw"){case"thenyaw":return{x:52.3,y:50};case"v3":return{x:52.8,y:45.3};default:return{x:50,y:50}}},pos2loc:function(t,e,n){var o=0<arguments.length&&void 0!==t?t:.01,r=1<arguments.length&&void 0!==e?e:.01,a=2<arguments.length&&void 0!==n?n:"thenyaw",l=this.getMapSize,i=this.getMapCenter,c=l(a),s=i(a);return{left:parseInt((o-s.x)*(c.x/100)),top:parseInt((r-s.y)*(c.y/100))}},loc2pos:function(t,e,n){var o=0<arguments.length&&void 0!==t?t:.01,r=1<arguments.length&&void 0!==e?e:.01,a=2<arguments.length&&void 0!==n?n:"thenyaw",l=this.getMapSize,i=this.getMapCenter,c=l(a),s=i(a);return{left:s.x+o*(100/c.x),top:s.y+r*(100/c.y)}},setCurrentPosition:function(){var i=document.querySelector(".js-coords-form");if(i){var c=document.querySelector("[data-map-name]").getAttribute("data-map-name");i.addEventListener("submit",function(t){t.preventDefault();var e=document.querySelector(".js-player-marker"),n=1*i.querySelector('input[name="lat"]').value,o=1*i.querySelector('input[name="lng"]').value,r=APP.loc2pos(n,o,c),a=100<r.left||100<r.top||r.top<0||r.left<0;if(e.classList.add("d-none"),a)APP.customAlert('\n\t\t\t\t\t<div class="h2 mb-0 text-center">\n\t\t\t\t\t\t<p>Unfortunately, it is not possible to set a point as it is outside the map.</p>\n\t\t\t\t\t</div>\n\t\t\t\t'),console.log(r);else{var l=new SmoothScroll;e.classList.remove("d-none"),e.style.left=r.left+"%",e.style.top=r.top+"%",function(t,e,n){var o=t.getAttribute("data-tippy-content").replace("{{ lat }}",e);o=o.replace("{{ lng }}",n),t._tippy.setContent(o)}(e,n,o),l.animateScroll(e,0,{speed:500,offset:function(t){return window.innerHeight/2}})}}),i.addEventListener("reset",function(t){document.querySelector(".js-player-marker").classList.add("d-none")})}},setFixedCoordsForm:function(){var t=document.querySelector(".js-coords-form");if(t){var e=window.pageYOffset+t.getBoundingClientRect().top;new Headroom(t,{offset:e}).init()}},mouseOverMap:function(){var t=document.querySelector(".map__layout");if(t){var o=t.getAttribute("data-map-name"),r=document.getElementById("position");t.onmousemove=function(t){var e=function(t){var e=t.target.getBoundingClientRect(),n=t.clientX-e.left,o=t.clientY-e.top,r=t.target.offsetWidth,a=t.target.offsetHeight,l=parseInt(n/r*100*10)/10,i=parseInt(o/a*100*10)/10;return{x:l,y:i}}(t),n=APP.pos2loc(e.x,e.y,o);r.innerHTML="lat: "+n.left+", long: "+n.top,r.style.display="block",r.style.top=e.y+"%",r.style.left=e.x+"%"},t.onmouseleave=function(){r.style.top=0,r.style.left=0,r.style.display="none"}}},modalCloseBtn:function(t){APP.documentOn("click",".js-modal-close",function(t){t.preventDefault(),APP.cache.tingleModal&&APP.cache.tingleModal.close()})},modalCloseListener:function(e){e.modalBoxContent.addEventListener("click",function(t){t.target==e.modalBoxContent&&e.close()})},modalGallery:function(){var n,r=function(t){t.closest(".tippy-popper")._tippy.hide()},a=function(t){var e=t.closest(".js-gallery"),n=[];return Array.prototype.forEach.call(e.querySelectorAll(".js-gallery-item"),function(t,e){t.closest(".swiper-slide-duplicate")||n.push(t)}),n},l=function(t){for(var e=[],n=0;n<t.length;n++){var o=t[n],r=o.getAttribute("data-title")?o.getAttribute("data-title"):"";e.push({src:o.getAttribute("href"),title:r})}return e},i=function(t,e){var n=new tingle.modal({closeMethods:["overlay","button","escape"],closeLabel:"Close",cssClass:["tingle-modal--gallery"],beforeOpen:function(){document.body.style.marginRight=APP.getScrollbarSize()+"px"},onOpen:function(){document.activeElement.blur(),APP.modalCloseListener(this),function(t){function e(t){var e=t.el.querySelector(".swiper-slide-active img").getAttribute("data-title");t.el.closest(".modal-gallery").querySelector(".modal-gallery__title").innerHTML=e}var n=t.querySelectorAll(".swiper-slide").length,o=new Swiper(t,{loop:1<n,allowTouchMove:!1,lazy:{loadPrevNext:!0,loadOnTransitionStart:!0},effect:"fade",fadeEffect:{crossFade:!0},speed:200,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},keyboard:{enabled:!0},pagination:{el:".modal-gallery__paging",type:"fraction"},init:!1});return o.on("init",function(){var t=this;setTimeout(function(){e(t)},10)}),o.on("slideChange",function(){var t=this;setTimeout(function(){e(t)},10)}),o.on("lazyImageReady",function(t,e){var n=this.$el[0].querySelectorAll("[data-object-fit]");APP.objectFitFallback(n)}),o.init(),Array.prototype.forEach.call(t.querySelectorAll("img"),function(t){t.addEventListener("click",function(t){o.slideNext()})}),o}(this.modal.querySelector(".swiper-container")).slideTo(e)},beforeClose:function(){return document.body.removeAttribute("style"),!0},onClose:function(){n.destroy(),delete APP.cache.tingleModal}});(APP.cache.tingleModal=n).setContent(t),n.open()},d=function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild},u="outerHTML"in(n=document.createElement("div"))?function(t){return t.outerHTML}:function(t){var e=n.cloneNode();return e.appendChild(t.cloneNode(!0)),e.innerHTML};APP.documentOn("click",".js-gallery-item",function(t){t.preventDefault(),r(this);var e=a(this),n=e.indexOf(this)+1,o=function(t,e){var n=d(t),o=n.querySelector("[data-for]"),r=o.parentNode;o.removeAttribute("data-for"),r.removeChild(o);for(var a=0;a<e.length;a++){var l=e[a],i=u(o),c=d(i),s=c.querySelector("img");s.setAttribute("data-src",l.src),s.setAttribute("data-title",l.title),r.appendChild(c)}return n}('<div class="modal-gallery">\n\t\t\t<span class="js-modal-close modal__close modal__close--pos-gallery">×</span>\n\t\t\t<div class="swiper-container modal-gallery__slider">\n\t\t\t\t<div class="swiper-wrapper">\n\t\t\t\t\t<div class="modal-gallery__slide swiper-slide" data-for>\n\t\t\t\t\t\t<div class="responsive-img modal-gallery__img-wrap">\n\t\t\t\t\t\t\t<img class="swiper-lazy" alt="" data-object-fit="scale-down">\n\t\t\t\t\t\t\t<div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="swiper-button-prev"></div>\n\t\t\t\t<div class="swiper-button-next"></div>\n\t\t\t</div>\n\t\t\t<div class="modal-gallery__footer">\n\t\t\t\t<div class="wrap modal-gallery__footer-inner">\n\t\t\t\t\t<div class="modal-gallery__title"></div>\n\t\t\t\t\t<div class="modal-gallery__paging"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>',l(e));i(o,n)})},lazyload:function(){void 0===APP.myLazyLoad?APP.myLazyLoad=new LazyLoad({elements_selector:".lazyload",callback_error:function(t){t.parentElement.classList.add("lazyload-error")}}):APP.myLazyLoad.update(),APP.objectFitFallback(document.querySelectorAll("[data-object-fit]"))},objectFitFallback:function(t){if("objectFit"in document.documentElement.style==!1){console.log("objectFit Fallback");for(var e=0;e<t.length;e++){var n=t[e],o=n.getAttribute("src"),r=n.getAttribute("data-object-fit"),a=void 0;a="contain"===r?"contain":"cover"===r?"cover":"auto";var l=n.parentElement;o&&(l.style.backgroundImage="url("+o+")",l.style.backgroundSize=a,l.classList.add("fit-img"))}}},svgIcons:function(){var t=document.querySelector("[data-svg-path]"),e=t.getAttribute("data-svg-path"),n=new XMLHttpRequest;n.onload=function(){t.innerHTML=this.responseText},n.open("get",e,!0),n.send()},polyfills:function(){var t;(t=Element.prototype).matches=t.matches||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector,t.closest=t.closest||function(t){return this?this.matches(t)?this:this.parentElement?this.parentElement.closest(t):null:null},Element.prototype.hasClass=function(t){return this.className&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(this.className)}},documentOn:function(t,n,o){document.addEventListener(t,function(t){var e=function(t,e){var n=e.replace(".",""),o=t.closest(e);return t.hasClass(n)?t:o||!1}(t.target,n);e&&o.bind(e)(t,e)})},detectIE:function(){!function(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");if(0<e){parseInt(t.substring(e+5,t.indexOf(".",e)),10);document.querySelector("body").className+=" IE"}if(0<t.indexOf("Trident/")){var n=t.indexOf("rv:");parseInt(t.substring(n+3,t.indexOf(".",n)),10);document.querySelector("body").className+=" IE"}var o=t.indexOf("Edge/");if(0<o){parseInt(t.substring(o+5,t.indexOf(".",o)),10);document.querySelector("body").className+=" IE"}}()},getScrollbarSize:function(){var t=void 0;if(void 0===t){var e=document.createElement("div");e.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -9999px;",document.body.appendChild(e),t=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return t},throttle:function(t,e){var n=!1;return function(){n||(t.call(),n=!0,setTimeout(function(){n=!1},e))}},getScreenSize:function(){var t=window.getComputedStyle(document.querySelector("body"),":after").getPropertyValue("content");return t=parseInt(t.match(/\d+/))}};APP.initBefore(),document.addEventListener("DOMContentLoaded",function(){APP.init()});
//# sourceMappingURL=main.js.map
